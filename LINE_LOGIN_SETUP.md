# üì± ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Line Login API

## üìã **‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Line Login**

### **1. ‡∏™‡∏£‡πâ‡∏≤‡∏á Line Developers Account**

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [Line Developers Console](https://developers.line.biz/)
2. ‡∏Ñ‡∏•‡∏¥‡∏Å **"Log in"** ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏ö‡∏±‡∏ç‡∏ä‡∏µ Line
3. ‡∏Ñ‡∏•‡∏¥‡∏Å **"Create"** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡πÉ‡∏´‡∏°‡πà

### **2. ‡∏™‡∏£‡πâ‡∏≤‡∏á Provider**

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **"Providers"** tab
2. ‡∏Ñ‡∏•‡∏¥‡∏Å **"Create"**
3. ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠ Provider: `readBOOK`
4. ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠ Company: ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
5. ‡∏Ñ‡∏•‡∏¥‡∏Å **"Create"**

### **3. ‡∏™‡∏£‡πâ‡∏≤‡∏á Channel**

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **"Channels"** tab
2. ‡∏Ñ‡∏•‡∏¥‡∏Å **"Create a new channel"**
3. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **"LINE Login"**
4. ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:
   - **Channel name**: `readBOOK Login`
   - **Channel description**: `Login system for readBOOK`
   - **App types**: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **"Web app"**
   - **Email address**: ‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
5. ‡∏Ñ‡∏•‡∏¥‡∏Å **"Create"**

### **4. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Channel**

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Channel ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
2. ‡∏Ñ‡∏•‡∏¥‡∏Å **"LINE Login"** tab
3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ **"App settings"**:
   - **App name**: `readBOOK`
   - **App description**: `Digital library platform`
   - **App icon**: ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô (512x512px)
   - **Privacy policy URL**: `https://your-domain.com/privacy`
   - **Terms of use URL**: `https://your-domain.com/terms`

### **5. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Callback URL**

1. ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ **"LINE Login"** tab
2. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **"Callback URL"** section
3. ‡πÄ‡∏û‡∏¥‡πà‡∏° URL:
   ```
   http://localhost:3000/api/auth/callback/line
   https://your-domain.com/api/auth/callback/line
   ```
4. ‡∏Ñ‡∏•‡∏¥‡∏Å **"Save"**

### **6. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Scopes**

1. ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ **"LINE Login"** tab
2. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **"OpenID Connect"** section
3. ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:
   - ‚úÖ **openid**
   - ‚úÖ **profile**
   - ‚úÖ **email**
4. ‡∏Ñ‡∏•‡∏¥‡∏Å **"Save"**

### **7. ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Channel**

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **"Basic settings"** tab
2. ‡∏Ñ‡∏•‡∏¥‡∏Å **"Issue"** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Channel
3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ **"Channel status"** ‡πÄ‡∏õ‡πá‡∏ô **"Published"**

### **8. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Credentials**

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **"Basic settings"** tab
2. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:
   - **Channel ID**: `1234567890`
   - **Channel secret**: `abcdef1234567890`
3. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **"Messaging API"** tab (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
4. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å **Channel access token**: `Bearer xxxxxx`

### **9. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment Variables**

‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå `.env.local`:

```env
# Line Login API
LINE_CHANNEL_ID=1234567890
LINE_CHANNEL_SECRET=abcdef1234567890
LINE_CHANNEL_ACCESS_TOKEN=Bearer xxxxxx
```

## üîß **‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö**

### **1. ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå**

```bash
npm run dev
```

### **2. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö**

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà `http://localhost:3000`
2. ‡∏Ñ‡∏•‡∏¥‡∏Å **"‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢ Line"**
3. ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞ redirect ‡πÑ‡∏õ Line Login
4. ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á
5. ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞ redirect ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ

### **3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå**

- ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
- ‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏° "‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö"
- ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ

## üö® **‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô**

### **Error: invalid_request**

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏**: Callback URL ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô Line Console

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ**:
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Callback URL ‡πÉ‡∏ô Line Console
2. ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ `http://localhost:3000/api/auth/callback/line`
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `NEXTAUTH_URL` ‡πÉ‡∏ô `.env.local`

### **Error: unauthorized_client**

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏**: Channel ID ‡∏´‡∏£‡∏∑‡∏≠ Channel Secret ‡∏ú‡∏¥‡∏î

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ**:
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `LINE_CHANNEL_ID` ‡πÅ‡∏•‡∏∞ `LINE_CHANNEL_SECRET`
2. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÉ‡∏´‡∏°‡πà‡∏à‡∏≤‡∏Å Line Console
3. ‡∏£‡∏µ‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå

### **Error: access_denied**

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏**: ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ**:
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Scopes ‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö App settings
3. ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á

### **Error: invalid_scope**

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏**: Scopes ‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ**:
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Scopes ‡πÉ‡∏ô Line Console
2. ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ `openid`, `profile`, `email`
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ OpenID Connect

## üìö **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°**

- [Line Login Documentation](https://developers.line.biz/en/docs/line-login/)
- [Line Developers Console](https://developers.line.biz/)
- [Line Login API Reference](https://developers.line.biz/en/reference/line-login-api/)

## ‚úÖ **Checklist**

- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á Line Developers Account
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á Provider
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á Channel
- [ ] ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ App settings
- [ ] ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Callback URL
- [ ] ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Scopes
- [ ] ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Channel
- [ ] ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment Variables
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

## üîê **Security Notes**

1. **Channel Secret**: ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î
2. **Access Token**: ‡πÉ‡∏ä‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô server-side
3. **Callback URL**: ‡πÉ‡∏ä‡πâ HTTPS ‡πÉ‡∏ô production
4. **Scopes**: ‡∏Ç‡∏≠‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô

---

**‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏**: ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Production ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô Callback URL ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ HTTPS
